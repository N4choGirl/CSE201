<!doctype html>
<html>
<canvas id="gameCanvas" width="480" height="480" style="border:1px solid #000000;"></canvas>
  <head>
    <title>Dot Bomb</title>
  </head>
  
  	<script src="Main.js"></script>
  
  <script>
  
	function getMousePos(canvas, evt) {
          var rect = canvas.getBoundingClientRect();
          return {
            x: Math.round(evt.clientX - rect.left),
            y: Math.round(evt.clientY - rect.top)
          };
      }
  	
	var canv = document.getElementById("gameCanvas");
	var ctx = canv.getContext("2d");
	ctx.fillStyle = "#000000";
	
	function makeGraph(nodeX, nodeY) {
		if(nodeX<1) nodeX=1;
		if(nodeX>8) nodeX=8;
		if(nodeY<1) nodeY=1;
		if(nodeY>8) nodeY=8;
		var numberOfNodes = nodeX*nodeY;
		for(var y=30;y<=(nodeY-1)*60+30;y+=60){
			for(var x=30;x<=(nodeX-1)*60+30;x+=60){
				testGraph.nodes.push(new Node(x,y,22)); 
			}
		}
		for(var i=0;i<testGraph.nodes.length-1;i++){
			var tempNode = testGraph.nodes[i];
			if(i-nodeX>=0) {
				tempNode.addNeighbor(testGraph.nodes[i-nodeX]);
			}
			if(i+nodeX<=numberOfNodes) {
				tempNode.addNeighbor(testGraph.nodes[i+nodeX]);
			}
			if(i+1<=numberOfNodes && (i+1)%nodeX!=0) {
				tempNode.addNeighbor(testGraph.nodes[i+1]);
			}
			if(i-1>=0 && i%nodeX!=0) {
				tempNode.addNeighbor(testGraph.nodes[i-1]);
			}
			testGraph.nodes[i] = tempNode;
		}
	}
	
	var testGraph = new Graph();
	//If you give it a number >8 or <1, it will act like you gave it the number 8
	makeGraph(4,5);
	
	//testGraph.draw(ctx);
	
	
	/*
	* A simple click listener
	* checks to see if a node was clicked, if so updates its count
	* then redraws the test graph
	*/
	canv.addEventListener("click", function(evt){
		coord = getMousePos(canv, evt);
		for(i=0; i<testGraph.nodes.length; i++){
			var tempNode = testGraph.nodes[i];
			if(tempNode.contains(coord.x, coord.y))
				tempNode.dotCount++;
		}
		testGraph.draw(ctx);
	}, false);
	
	testGraph.draw(ctx);
	
  </script>
</html>