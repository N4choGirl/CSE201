<!doctype html>
<html>
<canvas id="gameCanvas" width="480" height="480" style="border:1px solid #000000;"></canvas>
  <head>
    <title>Dot Bomb</title>
  </head>
  
  	<script src="Main.js"></script>
  
  <script>
  
	function getMousePos(canvas, evt) {
          var rect = canvas.getBoundingClientRect();
          return {
            x: Math.round(evt.clientX - rect.left),
            y: Math.round(evt.clientY - rect.top)
          };
      }
  	
	var canv = document.getElementById("gameCanvas");
	var ctx = canv.getContext("2d");
	ctx.fillStyle = "#000000";
	
	function makeGraph(nodeX, nodeY) {
		if(nodeX<1) nodeX=1;
		if(nodeX>8) nodeX=8;
		if(nodeY<1) nodeY=1;
		if(nodeY>8) nodeY=8;
		var numberOfNodes = nodeX*nodeY;
		for(var y=30;y<=(nodeY-1)*60+30;y+=60){
			for(var x=30;x<=(nodeX-1)*60+30;x+=60){
				testGraph.nodes.push(new Node(x,y,22)); 
			}
		}
		for(var i=0;i<testGraph.nodes.length-1;i++){
			var tempNode = testGraph.nodes[i];
			if(i-nodeX>=0) {
				tempNode.addNeighbor(testGraph.nodes[i-nodeX]);
			}
			if(i+nodeX<=numberOfNodes) {
				tempNode.addNeighbor(testGraph.nodes[i+nodeX]);
			}
			if(i+1<=numberOfNodes && (i+1)%nodeX!=0) {
				tempNode.addNeighbor(testGraph.nodes[i+1]);
			}
			if(i-1>=0 && i%nodeX!=0) {
				tempNode.addNeighbor(testGraph.nodes[i-1]);
			}
			testGraph.nodes[i] = tempNode;
		}
	}
	
	var testGraph = new Graph(canv);
	//If you give it a number >8 for x or y, it will act like you gave it the number 8
	//If you give it a number <1 for x or y, it will act like you gave it the number 1
	makeGraph(8,8);
	
	var player1 = new Player("#3169c4");
	var player2 = new Player("#c43f31");
	testGraph.players = [player1, player2];
	
	
	var temp = testGraph.nodes[10];
	//document.write(temp.neighbors.length);
	
	testGraph.draw(ctx);
	//temp.toString();
	//for(var i=0;i<temp.neighbors.length;i++) {
		//temp.neighbors[i].toString();
	//}
	
	/*
	* A simple click listener
	* checks to see if a node was clicked, if so updates its count
	* then redraws the test graph
	*/
	canv.addEventListener("click", function(evt){
		//debugger;
		coord = getMousePos(canv, evt);
		testGraph.makeMove(coord.x, coord.y);
		testGraph.draw();
	}, false);
	
	//testGraph.draw(ctx);
	
  </script>
</html>